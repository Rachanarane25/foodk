<!DOCTYPE html>
<html>
<head>
  <title>Food Manager Login</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
<!-- Dark / Light Toggle -->
<button class="toggle" onclick="toggleTheme()">ðŸŒ™</button>

<!-- LOGIN CARD -->
<div class="container">
  <h2>Food Manager System</h2>

  <form action="/auth/login" method="POST">
    <input name="email" type="email" placeholder="Email" required>
    <input name="password" type="password" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>

  <p class="link">
    New user? <a href="register.html">Create account</a>
  </p>
</div>

<!-- POPUP MODAL -->
<div id="popup" class="popup">
  <div class="popup-box">
    <h3>Login Error</h3>
    <p id="popupMsg"></p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<!-- THEME SCRIPT -->
<script>
function toggleTheme() {
  document.body.classList.toggle("dark");
  localStorage.setItem(
    "theme",
    document.body.classList.contains("dark") ? "dark" : "light"
  );
}

if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark");
}
</script>

<!-- LOGIN ERROR POPUP SCRIPT -->
<script>
window.onload = () => {
  const params = new URLSearchParams(window.location.search);
  const error = params.get("error");

  if (!error) return;

  const popup = document.getElementById("popup");
  const msg = document.getElementById("popupMsg");

  if (error === "wrong") {
    msg.innerText = "Incorrect password. Please try again.";
  }

  if (error === "notfound") {
    msg.innerText = "Account not found. Please register first.";
  }

  popup.style.display = "flex";
};

function closePopup() {
  document.getElementById("popup").style.display = "none";
  window.history.replaceState({}, document.title, "/login.html");
}
</script>

</body>
</html>
